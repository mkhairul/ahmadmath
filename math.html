<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Math Quiz & Practice App</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
  <div class="max-w-4xl mx-auto">
    <!-- Header -->
    <header class="text-center mb-8">
      <h1 class="text-4xl font-bold text-indigo-900 mb-2">Math Practice App</h1>
      <p class="text-gray-600">Choose your practice mode below</p>
    </header>

    <!-- Mode Selection -->
    <div id="modeSelection" class="bg-white rounded-lg shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Select Mode</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <button onclick="showFreeform()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-4 px-6 rounded-lg transition">
          üé® Freeform Canvas
        </button>
        <button onclick="showQuizSetup()" class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-4 px-6 rounded-lg transition">
          üìù Fixed Questions Quiz
        </button>
      </div>
    </div>

    <!-- Freeform Mode -->
    <div id="freeformMode" class="hidden bg-white rounded-lg shadow-lg p-6">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-semibold text-gray-800">Freeform Practice</h2>
        <button onclick="backToMenu()" class="text-gray-600 hover:text-gray-800">‚Üê Back</button>
      </div>
      
      <!-- Stopwatch -->
      <div class="bg-gray-100 rounded-lg p-4 mb-4 text-center">
        <div class="text-4xl font-mono font-bold text-gray-800 mb-3" id="freeformTimer">00:00:00</div>
        <div class="space-x-2">
          <button id="freeformStartBtn" onclick="startFreeformTimer()" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-lg transition">
            Start
          </button>
          <button id="freeformStopBtn" onclick="stopFreeformTimer()" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-6 rounded-lg transition" disabled>
            Stop
          </button>
          <button onclick="resetFreeformTimer()" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-6 rounded-lg transition">
            Reset
          </button>
        </div>
      </div>

      <!-- Canvas -->
      <div class="border-4 border-gray-300 rounded-lg overflow-hidden">
        <canvas id="freeformCanvas" width="800" height="500" class="w-full cursor-crosshair bg-white"></canvas>
      </div>
      
      <div class="mt-4 flex justify-between items-center">
        <div class="space-x-2">
          <button onclick="clearCanvas()" class="bg-orange-600 hover:bg-orange-700 text-white font-semibold py-2 px-4 rounded-lg transition">
            Clear Canvas
          </button>
        </div>
        <div class="flex items-center space-x-2">
          <label class="text-gray-700 font-semibold">Brush Size:</label>
          <input type="range" id="brushSize" min="1" max="10" value="3" class="w-32">
          <span id="brushSizeValue" class="text-gray-700 font-mono">3</span>
        </div>
      </div>
    </div>

    <!-- Quiz Setup -->
    <div id="quizSetup" class="hidden bg-white rounded-lg shadow-lg p-6">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-semibold text-gray-800">Quiz Setup</h2>
        <button onclick="backToMenu()" class="text-gray-600 hover:text-gray-800">‚Üê Back</button>
      </div>

      <div class="space-y-4">
        <!-- Number of Questions -->
        <div>
          <label class="block text-gray-700 font-semibold mb-2">Number of Questions:</label>
          <input type="number" id="numQuestions" min="1" max="50" value="10" class="w-full border-2 border-gray-300 rounded-lg p-2">
        </div>

        <!-- Question Types -->
        <div>
          <label class="block text-gray-700 font-semibold mb-2">Question Types:</label>
          <div class="grid grid-cols-2 gap-2">
            <label class="flex items-center space-x-2 p-3 border-2 border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer">
              <input type="checkbox" id="typeAddition" checked class="w-5 h-5">
              <span>‚ûï Addition</span>
            </label>
            <label class="flex items-center space-x-2 p-3 border-2 border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer">
              <input type="checkbox" id="typeSubtraction" checked class="w-5 h-5">
              <span>‚ûñ Subtraction</span>
            </label>
            <label class="flex items-center space-x-2 p-3 border-2 border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer">
              <input type="checkbox" id="typeMultiplication" checked class="w-5 h-5">
              <span>‚úñÔ∏è Multiplication</span>
            </label>
            <label class="flex items-center space-x-2 p-3 border-2 border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer">
              <input type="checkbox" id="typeDivision" checked class="w-5 h-5">
              <span>‚ûó Division</span>
            </label>
          </div>
        </div>

        <button onclick="startQuiz()" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-lg transition">
          Start Quiz
        </button>
      </div>
    </div>

    <!-- Quiz Mode -->
    <div id="quizMode" class="hidden bg-white rounded-lg shadow-lg p-6">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-semibold text-gray-800">Quiz in Progress</h2>
        <div class="text-xl font-mono font-bold text-indigo-600" id="quizTimer">00:00:00</div>
      </div>

      <!-- Progress -->
      <div class="mb-6">
        <div class="flex justify-between text-sm text-gray-600 mb-1">
          <span>Progress</span>
          <span id="progressText">0 / 0</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-3">
          <div id="progressBar" class="bg-indigo-600 h-3 rounded-full transition-all" style="width: 0%"></div>
        </div>
      </div>

      <!-- Question -->
      <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-8 mb-6 text-center">
        <div class="text-5xl font-bold text-gray-800 mb-6" id="questionText">2 + 2 = ?</div>
        <input type="number" id="answerInput" class="text-3xl text-center border-4 border-indigo-300 rounded-lg p-4 w-48 focus:outline-none focus:border-indigo-600" placeholder="?">
      </div>

      <div class="flex space-x-4">
        <button onclick="submitAnswer()" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition">
          Submit Answer
        </button>
        <button onclick="endQuiz()" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-6 rounded-lg transition">
          End Quiz
        </button>
      </div>
    </div>

    <!-- Quiz Results -->
    <div id="quizResults" class="hidden bg-white rounded-lg shadow-lg p-6">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4 text-center">Quiz Complete! üéâ</h2>
      
      <div class="bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6 mb-6">
        <div class="grid grid-cols-2 gap-4 text-center">
          <div>
            <div class="text-gray-600 mb-1">Score</div>
            <div class="text-4xl font-bold text-indigo-600" id="finalScore">0/0</div>
          </div>
          <div>
            <div class="text-gray-600 mb-1">Time</div>
            <div class="text-4xl font-bold text-purple-600" id="finalTime">00:00</div>
          </div>
        </div>
      </div>

      <div class="space-y-2">
        <button onclick="backToMenu()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg transition">
          Back to Menu
        </button>
        <button onclick="showQuizSetup()" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-lg transition">
          Try Again
        </button>
      </div>
    </div>
  </div>

  <script>
    // Freeform Mode Variables
    let freeformInterval = null;
    let freeformSeconds = 0;
    let isDrawingEnabled = false;
    let canvas, ctx;
    let isDrawing = false;

    // Quiz Mode Variables
    let quizInterval = null;
    let quizSeconds = 0;
    let questions = [];
    let currentQuestion = 0;
    let correctAnswers = 0;

    function drawGrid() {
      const gridSize = 20; // Grid cell size in pixels
      ctx.save();
      ctx.strokeStyle = '#e5e7eb'; // Light gray color for grid
      ctx.lineWidth = 0.5;

      // Draw vertical lines
      for (let x = 0; x <= canvas.width; x += gridSize) {
        ctx.beginPath();
        ctx.moveTo(x, 0);
        ctx.lineTo(x, canvas.height);
        ctx.stroke();
      }

      // Draw horizontal lines
      for (let y = 0; y <= canvas.height; y += gridSize) {
        ctx.beginPath();
        ctx.moveTo(0, y);
        ctx.lineTo(canvas.width, y);
        ctx.stroke();
      }

      ctx.restore();
    }

    // Initialize Canvas
    function initCanvas() {
      canvas = document.getElementById('freeformCanvas');
      ctx = canvas.getContext('2d');
      ctx.lineWidth = 3;
      ctx.lineCap = 'round';
      ctx.strokeStyle = '#000';

      drawGrid();

      // Mouse events
      canvas.addEventListener('mousedown', startDrawing);
      canvas.addEventListener('mousemove', draw);
      canvas.addEventListener('mouseup', stopDrawing);
      canvas.addEventListener('mouseout', stopDrawing);

      // Touch events
      canvas.addEventListener('touchstart', handleTouch);
      canvas.addEventListener('touchmove', handleTouch);
      canvas.addEventListener('touchend', stopDrawing);

      // Brush size slider
      document.getElementById('brushSize').addEventListener('input', (e) => {
        ctx.lineWidth = e.target.value;
        document.getElementById('brushSizeValue').textContent = e.target.value;
      });
    }

    function startDrawing(e) {
      if (!isDrawingEnabled) return;
      isDrawing = true;
      const rect = canvas.getBoundingClientRect();
      ctx.beginPath();
      ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
    }

    function draw(e) {
      if (!isDrawing || !isDrawingEnabled) return;
      const rect = canvas.getBoundingClientRect();
      ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
      ctx.stroke();
    }

    function stopDrawing() {
      isDrawing = false;
    }

    function handleTouch(e) {
      e.preventDefault();
      if (!isDrawingEnabled) return;
      const touch = e.touches[0];
      const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 'mousemove', {
        clientX: touch.clientX,
        clientY: touch.clientY
      });
      canvas.dispatchEvent(mouseEvent);
    }

    function clearCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawGrid();
    }

    // Navigation
    function showFreeform() {
      document.getElementById('modeSelection').classList.add('hidden');
      document.getElementById('freeformMode').classList.remove('hidden');
      if (!canvas) initCanvas();
    }

    function showQuizSetup() {
      document.getElementById('modeSelection').classList.add('hidden');
      document.getElementById('quizSetup').classList.remove('hidden');
      document.getElementById('quizMode').classList.add('hidden');
      document.getElementById('quizResults').classList.add('hidden');
    }

    function backToMenu() {
      document.getElementById('modeSelection').classList.remove('hidden');
      document.getElementById('freeformMode').classList.add('hidden');
      document.getElementById('quizSetup').classList.add('hidden');
      document.getElementById('quizMode').classList.add('hidden');
      document.getElementById('quizResults').classList.add('hidden');
      
      // Reset timers
      stopFreeformTimer();
      resetFreeformTimer();
      if (quizInterval) clearInterval(quizInterval);
    }

    // Freeform Timer
    function startFreeformTimer() {
      if (freeformInterval) return;
      isDrawingEnabled = true;
      canvas.style.cursor = 'crosshair';
      document.getElementById('freeformStartBtn').disabled = true;
      document.getElementById('freeformStopBtn').disabled = false;
      
      freeformInterval = setInterval(() => {
        freeformSeconds++;
        updateTimerDisplay('freeformTimer', freeformSeconds);
      }, 1000);
    }

    function stopFreeformTimer() {
      if (!freeformInterval) return;
      clearInterval(freeformInterval);
      freeformInterval = null;
      isDrawingEnabled = false;
      canvas.style.cursor = 'not-allowed';
      document.getElementById('freeformStartBtn').disabled = false;
      document.getElementById('freeformStopBtn').disabled = true;
    }

    function resetFreeformTimer() {
      stopFreeformTimer();
      freeformSeconds = 0;
      updateTimerDisplay('freeformTimer', 0);
    }

    function updateTimerDisplay(elementId, seconds) {
      const hours = Math.floor(seconds / 3600);
      const minutes = Math.floor((seconds % 3600) / 60);
      const secs = seconds % 60;
      document.getElementById(elementId).textContent = 
        `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
    }

    // Quiz Functions
    function startQuiz() {
      const numQuestions = parseInt(document.getElementById('numQuestions').value);
      const types = [];
      
      if (document.getElementById('typeAddition').checked) types.push('addition');
      if (document.getElementById('typeSubtraction').checked) types.push('subtraction');
      if (document.getElementById('typeMultiplication').checked) types.push('multiplication');
      if (document.getElementById('typeDivision').checked) types.push('division');

      if (types.length === 0) {
        alert('Please select at least one question type!');
        return;
      }

      // Generate questions
      questions = [];
      for (let i = 0; i < numQuestions; i++) {
        const type = types[Math.floor(Math.random() * types.length)];
        questions.push(generateQuestion(type));
      }

      currentQuestion = 0;
      correctAnswers = 0;
      quizSeconds = 0;

      document.getElementById('quizSetup').classList.add('hidden');
      document.getElementById('quizMode').classList.remove('hidden');

      // Start timer
      quizInterval = setInterval(() => {
        quizSeconds++;
        updateTimerDisplay('quizTimer', quizSeconds);
      }, 1000);

      showQuestion();
    }

    function generateQuestion(type) {
      let num1, num2, answer, question;

      switch(type) {
        case 'addition':
          num1 = Math.floor(Math.random() * 50) + 1;
          num2 = Math.floor(Math.random() * 50) + 1;
          answer = num1 + num2;
          question = `${num1} + ${num2} = ?`;
          break;
        case 'subtraction':
          num1 = Math.floor(Math.random() * 50) + 20;
          num2 = Math.floor(Math.random() * num1) + 1;
          answer = num1 - num2;
          question = `${num1} - ${num2} = ?`;
          break;
        case 'multiplication':
          num1 = Math.floor(Math.random() * 12) + 1;
          num2 = Math.floor(Math.random() * 12) + 1;
          answer = num1 * num2;
          question = `${num1} √ó ${num2} = ?`;
          break;
        case 'division':
          num2 = Math.floor(Math.random() * 10) + 2;
          answer = Math.floor(Math.random() * 10) + 1;
          num1 = num2 * answer;
          question = `${num1} √∑ ${num2} = ?`;
          break;
      }

      return { question, answer };
    }

    function showQuestion() {
      if (currentQuestion >= questions.length) {
        endQuiz();
        return;
      }

      const q = questions[currentQuestion];
      document.getElementById('questionText').textContent = q.question;
      document.getElementById('answerInput').value = '';
      document.getElementById('answerInput').focus();
      
      // Update progress
      document.getElementById('progressText').textContent = `${currentQuestion + 1} / ${questions.length}`;
      const progress = ((currentQuestion + 1) / questions.length) * 100;
      document.getElementById('progressBar').style.width = `${progress}%`;
    }

    function submitAnswer() {
      const userAnswer = parseInt(document.getElementById('answerInput').value);
      const correctAnswer = questions[currentQuestion].answer;

      if (userAnswer === correctAnswer) {
        correctAnswers++;
      }

      currentQuestion++;
      showQuestion();
    }

    function endQuiz() {
      clearInterval(quizInterval);
      quizInterval = null;

      document.getElementById('quizMode').classList.add('hidden');
      document.getElementById('quizResults').classList.remove('hidden');

      document.getElementById('finalScore').textContent = `${correctAnswers}/${questions.length}`;
      
      const minutes = Math.floor(quizSeconds / 60);
      const seconds = quizSeconds % 60;
      document.getElementById('finalTime').textContent = 
        `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    }

    // Allow Enter key to submit answer
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('answerInput')?.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') submitAnswer();
      });
    });
  </script>
</body>
</html>
